# 15장. 쓰레드

## 15-1. 프로그램, 프로세스, 쓰레드

- 컴퓨터 구성 요소
    - CPU (중앙 처리 장치) + 메모리 + 하드디스크
        - cpu는 빠르고, 하드웨어는 느림
        - 하드웨어 쪽에 맞춰짐
        - 메모리는 CPU보다는 느리지만 거의 근접한 속도로 동작
            - 하드 디스크에 저장된 프로그램이 실행되기 위해서는 먼저 프로그램을 메모리로 로딩하는 과정을 거쳐 프로세스 상태로 만들어야 함
            - 메모리는 그때 그때 필요한 부분만을 동적으로 할당
                - 멀티 프로세스
                    - 동일한 프로그램을 메모리에 2번 로딩
- 프로그램
    - 하드디스크에 저장된 파일들의 모임
    - 명령어들의 모음
- 프로세스
    - 메모리 상에 로딩된 프로그램



- 쓰레드
    - CPU를 사용하는 최소 단위
    - 한정된 코어의 수를 갖는 CPU를 여러 개의 작업이 나눠 사용하는 것
- 멀티 쓰레드
    - 동시성과 병렬성을 가지고 처리됨
        - 동시성 (concurrency)
            - 매우 짧은 간격으로 교차 실행되어, 두 작업이 동시에 실행되는 것처럼 보이는
        - 병렬성 (parallelism)
            - 각각의 작업을 각각의 코어에 할당해 동시에 실행

---

- 멀티 태스킹 ****(Multi-tasking)****
    - 서로 다른 프로그램 사용
        - 음악들으면서 워드 작성
    - task(업무) 동시

### 15-2. 쓰레드의 생성 및 실행

- 쓰레드 생성 방법
    - 방법 1
        - Thread 클래스를 상속받아 run( ) 메서드를 오버라이딩(재정의)하는 것
    - 방법 2
        - Runnable 인터페이스 구현한 Runnable 객체 생성 후 run ( ) 구현
        - Thread 객체를 생성할 때 앞 단계에서 생성한 Runnable 객체를 생성자로 전달
            - Runnable 객체의 내부에는 start( ) 메서드가 존재하지 않기 때문에 start( )를 갖고 있는 Thread 객체를 생성해야 함

### 15-3. 쓰레드의 속성

| 함수 | 설명 |
| --- | --- |
| static Thread Thread.currentThread( ) | 현재 쓰레드 객체 참조값 얻어오기 |
| static int Thread.activeCount( ) | 실행 중인 쓰레드의 개수 가져오기 |
| String setName(String name) | 쓰레드 이름 설정하기 |
| String getName( ) | 쓰레드 이름 가져오기 |
| void setPriority(int priority) | 쓰레드 객체의 우선 순위 정하기 |
| int getPriority( ) | 쓰레드 객체의 우선순위 가져오기 |
- 쓰레드의 우선 순위
    - 모든 쓰레드는 1~10 사이의 우선순위를 갖고 있음 (1 : 가장 낮은 순위)
    - 우선순위를 지정하지 않으면 기본값으로 5의 우선순위를 가짐
    - 우선순위는 동시성과 관계 있음
        - 2개의 쓰레드가 2개의 CPU 코어에 각각 할당돼 동작하는 쓰레드 병렬성일 때 우선순위는 의미가 없음
        - 2개의 작업이 하나의 CPU 코어에서 동작할 때 쓰레드의 동시성에 따라 2개의 작업은 일정 시간 간격으로 번갈아가면서 실행 됨
        - 우선순위가 높으면 상대적으로 더 많은 시간을 할당받게 됨
- 쓰레드의 데몬 설정
    - 데몬
        - 주 스레드의 작업을 돕는 보조적인 역할을 수행하는 스레드
        - 사용자가 신경쓰지 않으면서 백그라운드에서 일하는 것

### 15-4. 쓰레드의 동기화

- 동기화 개념
    - 동기화
        - 하나의 작업이 완전히 완료된 후 다른 작업을 수행하는 것
            - 하나의 쓰레드가 객체를 사용한 후 다른 객체가 사용할 수 있도록 하는 설정
    - 비동기
        - 하나의 작업 명령 이후 완료 여부와 상관없이 바로 다른 작업 명령을 수행하는 것
- 자바 동기화 방법
    1. 메서드 동기화 
        - 메서드 리턴 타입 앞에 `synchronized`키워드 추가
    2. 블록 동기화 
        - 전체 메서드를 통기화 하지 않고, 해당 부분만 동기화
- 동기화 원리
    - 모든 객체는 자신만의 열쇠(key)를 하나씩 가지고 있음

### 15-5. 쓰레드의 상태

- 쓰레드는 객체가 생성, 실행, 종료되기까지 다양한 상태를 가짐
- Enum 타입으로 정의 되어 있음
    - `NEW`
        - Thread myThread = new MyThread(); // start 시작 전
    - `RUNNABLE`
        - myThread.strat();
    - `TERMINATED`
        - run 완료
    - `TIMED_WAITING`
        - Thread.sleep(1000)
        - join(1000)
    - `BLOCKED`
    - `WAITING`
        - join( ), wait( ) : 해당 쓰레드가 완료될 때까지 main 쓰레드는 기다리겠다는 의미
        - notify( ), notifyAll( )
- `Thread.yield( )` : 다른 쓰레드에게 CPU 사용을 인위적으로 양보하고, 자신은 실행 대기 상태로 전환